# UTF-8 → Shift_JIS 一発変換ツール

日本語版Excelの文字化けを ほぼ解消！ドラッグ＆ドロップで簡単にUTF-8ファイルをShift_JISに変換できるツールです。

## 特徴

- 簡単操作: ドラッグ&ドロップだけで変換完了
- 自動検出: ファイルの文字コードを自動判定
- 一括処理: 複数ファイルの同時変換に対応
- 日本語対応: 日本語版Excelでの文字化け問題を解決
- 実行ファイル: Pythonのインストール不要（exe形式で提供）

## 用途

- UTF-8などのファイルを日本語版Excelで開く際の文字化け解消
- 外部システムからのCSV・テキストファイルの文字コード統一
- レガシーシステムとの文字コード互換性確保

## 動作環境

### 必要な環境
- **OS**: Windows 11、10（32bit及び64bit）
- **その他**: 実行ファイル（exe形式）には必要なライブラリがすべて組み込まれているため、Pythonのインストールは不要

### ファイル制限
- **最大ファイルサイズ**: 100MB
- **対応ファイル**: テキスト形式のファイル（csv、txt、html等）
- **非対応ファイル**: バイナリファイル（exe、jpg、pdf等）

## 使用方法

### 1. 初回実行時の注意

初回実行時、Windowsの保護機能により警告が表示されます：

1. 「詳細情報」をクリック
2. 「実行」をクリック

### 2. 基本的な使用方法

#### 単一ファイルの変換
1. 変換したいファイルを実行ファイル（exe形式）にドラッグ＆ドロップ
2. ファイル（文字コードは自動検出）が変換処理される
3. 処理結果が表示される
4. 変換後のファイルが元のフォルダに作成される

#### 複数ファイルの一括変換
1. 複数のファイルを選択して実行ファイルにドラッグ＆ドロップ
2. 各ファイル（文字コードは自動検出）が順次処理される
3. 処理完了後に一括結果が表示される
4. 変換後のファイルが元のフォルダに作成される

## 出力ファイル名の付け方

変換後のファイルは元のファイルと同じフォルダに、以下の命名規則で保存されます：

- **正常変換**: `元のファイル名_sjis.拡張子`
- **代替文字含む変換**: `元のファイル名_sjisx.拡張子`

### 重要な注意事項

変換前の元ファイルにShift_JISに対応していない文字が含まれている場合、変換後のファイルでは該当文字が代替文字「？」に変換され、ファイル名に `_sjisx` が付与されます。

**具体例**:
- 「髙橋さん」→「？橋さん」
- 「𠮷田さん」→「？田さん」  
- 「高﨑さん」→「高？さん」

## 処理結果の表示例

### 成功パターン
```
data.csv → data_sjis.csv (UTF-8からSHIFT_JISへ変換)
```

### 代替文字を含む変換
```
document.txt → document_sjisx.txt (UTF-8からSHIFT_JISへ変換、代替文字に置換あり)
```

### スキップパターン
```
existing.csv → SHIFT_JISのためスキップ
empty.txt → 空ファイルのためスキップ
```

### エラーパターン
```
binary.exe → 変換失敗 (バイナリファイルです)
large.csv → 変換失敗 (ファイルサイズが大きすぎます（105MB）)
```

## 注意事項

### データの事前バックアップ
**変換前に必ず元ファイルのバックアップを取ってください。**

### 代替文字への変換について

Shift_JISが対応しない文字は、代替文字として「？」に変換されます。対応しない文字の主な例：

#### 丸囲み数字・文字
```
①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳
ⒶⒷⒸⒹⒺⒻⒼⒽⒾⒿⓀⓁⓂⓃⓄⓅⓆⓇⓈⓉⓊⓋⓌⓍⓎⓏ
ⓐⓑⓒⓓⓔⓕⓖⓗⓘⓙⓚⓛⓜⓝⓞⓟⓠⓡⓢⓣⓤⓥⓦⓧⓨⓩ
```

#### 特殊記号・絵文字
```
☆★♪♫♬♭♮♯※‼⁇⁈⁉
™®©℃℉Ω∞∝∴∵∠⊥∥∪∩∈∋⊆⊇⊂⊃
😀😊😂🤔👍❤️🌟⭐💫🎵🎶🎼
```

#### 罫線記号など
```
╔╗╚╝╠╣╦╩╬╞╡╟╢╤╧╪╫╬
▲△▼▽◆◇○●◎◐◑◒◓
```

#### その他の特殊文字
- 髙（はしごだか）、𠮷（つちよし）、﨑（たつさき）等の異体字
- 一部の旧字体・異体字
- Unicode特有の記号・文字

### 処理の中断
処理中に`Ctrl+C`キーで中断できます。中断した場合、処理中のファイルは未完了状態となります。

## 対応文字コード

### 入力側対応文字コード
- UTF-8（BOMなし、BOMありのUTF-8-SIGも含む）
- UTF-16LE（リトルエンディアン）
- UTF-16BE（ビッグエンディアン）
- EUC-JP
- ISO-2022-JP など

### 出力側対応文字コード
- **Shift_JIS（シフトJIS）のみ**

## インストール・実行

### 実行ファイルのダウンロード

1. Releasesページから最新版のZIPファイルをダウンロード
2. ZIPファイルを解凍
3. `sjis_converter.exe` をダブルクリックして実行

### ソースコードからの実行

```bash
# 必要なライブラリのインストール
pip install chardet

# 実行
python sjis_converter.py [ファイルパス]
```

### 実行ファイルの作成

```bash
# PyInstallerでEXEファイル作成
pip install pyinstaller
pyinstaller --onefile sjis_converter.py
```

## 開発環境

- Python 3.x
- chardet（文字コード検出ライブラリ）

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

---

**注意**: このツールは、日本語版Excelの文字コード問題を解決するために作成されました。レガシーシステムで文字化けが発生する氏名については、本ツールでも同様の文字化けが発生する可能性があります。公用文書等での使用の際は、この点にご注意ください。

